<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MONK</title>
  <meta name="description" content="MONK — field manuals for orientation." />
  <style>
    :root{
      --bg:#fbfaf7;
      --ink:#111;
      --muted:#6b6b6b;
      --rule:#e7e2d8;
      --chip:#f2eee7;
      --focus:#0b57d0;
      --max: 760px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--ink);
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      line-height:1.65;
      letter-spacing:0.01em;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }
    a{color:inherit}
    .wrap{max-width:var(--max); margin:0 auto; padding:28px 18px 72px}
    header{padding:18px 0 10px}
    .kicker{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; letter-spacing:0.18em; text-transform:uppercase; font-size:12px; color:var(--muted)}
    h1{margin:10px 0 8px; font-size:40px; letter-spacing:0.06em}
    .sub{margin:0; color:var(--muted); max-width:60ch}
    .bar{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin:18px 0 14px}
    
    .chip button{all:unset; cursor:pointer}
    
    
    .search input{border:none; outline:none; width:100%; font-family: ui-sans-serif, system-ui; font-size:14px; background:transparent}
    
    .btn:focus{outline:2px solid var(--focus); outline-offset:2px}
    nav{display:flex; gap:8px; flex-wrap:wrap; margin:0 0 14px}
    nav a{font-family: ui-sans-serif, system-ui; font-size:13px; color:var(--muted); text-decoration:none; padding:8px 10px; border:1px solid var(--rule); border-radius:999px; background:#fff}
    nav a:hover{color:#111}
    hr{border:none; border-top:1px solid var(--rule); margin:18px 0}
    section{margin:26px 0}
    .section-title{display:flex; align-items:baseline; justify-content:space-between; gap:10px}
    h2{margin:0; font-size:22px; letter-spacing:0.02em}
    .meta{font-family: ui-sans-serif, system-ui; font-size:12px; color:var(--muted)}
    .preface{padding:14px 14px; border:1px solid var(--rule); border-radius:14px; background:#fff; margin:12px 0 18px}
    .preface .label{font-family: ui-sans-serif, system-ui; font-size:12px; color:var(--muted); letter-spacing:0.18em; text-transform:uppercase}
    .preface .line{margin:8px 0 0; font-size:18px}

    .reflection{padding:16px 14px; border:1px solid var(--rule); border-radius:14px; background:#fff; margin:12px 0}
    .r-head{display:flex; align-items:baseline; justify-content:space-between; gap:10px; margin-bottom:6px}
    .r-num{font-family: ui-sans-serif, system-ui; font-size:12px; letter-spacing:0.18em; text-transform:uppercase; color:var(--muted)}
    .r-title{font-size:16px; margin:0}
    
    .mini{border:1px solid var(--rule); background:var(--chip); border-radius:10px; padding:6px 8px; font-family: ui-sans-serif, system-ui; font-size:12px; cursor:pointer}
    .mini:focus{outline:2px solid var(--focus); outline-offset:2px}
    .r-body{margin:10px 0 0; white-space:pre-wrap}
    .hidden{display:none !important}

    .laws{display:grid; grid-template-columns: repeat(1, minmax(0, 1fr)); gap:10px}
    .law{padding:12px 14px; border:1px solid var(--rule); border-radius:14px; background:#fff}
    .law .n{font-family: ui-sans-serif, system-ui; font-size:12px; color:var(--muted); letter-spacing:0.18em; text-transform:uppercase}
    .law .t{margin:6px 0 0; font-size:15px}

    footer{margin-top:34px; color:var(--muted); font-family: ui-sans-serif, system-ui; font-size:12px}

    @media (min-width: 720px){
      .laws{grid-template-columns: repeat(2, minmax(0, 1fr));}
    }

    .pause{height:100vh}

    /* Reader Mode (B) */
    body.reader-on{overflow:hidden}
    body.reader-on .wrap{display:none}
    .reader{position:fixed; inset:0; background:var(--bg); color:var(--ink); display:none}
    body.reader-on .reader{display:block}
    .reader-wrap{max-width:var(--max); margin:0 auto; height:100%; padding:28px 18px 28px; display:flex; flex-direction:column; gap:14px}
    .reader-top{display:flex; align-items:baseline; justify-content:space-between; gap:10px}
    .reader-mark{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; letter-spacing:0.18em; text-transform:uppercase; font-size:12px; color:var(--muted)}
    .reader-idx{font-family: ui-sans-serif, system-ui; font-size:12px; color:var(--muted)}
    .reader-card{flex:1; overflow:auto; background:#fff; border:1px solid var(--rule); border-radius:14px; padding:18px 16px}
    .reader-title{margin:0; font-size:18px}
    .reader-body{margin:12px 0 0; white-space:pre-wrap}
    .reader-nav{display:flex; justify-content:space-between; gap:10px}
    .reader-btn{border:1px solid var(--rule); background:#fff; border-radius:12px; padding:10px 12px; font-family: ui-sans-serif, system-ui; font-size:14px; cursor:pointer}
    .reader-btn:focus{outline:2px solid var(--focus); outline-offset:2px}
    .reader-btn[disabled]{opacity:.5; cursor:default}

    /* Reader Mode (B) */
    body.reader-on{overflow:hidden}
    body.reader-on .wrap{display:none}
    .reader{position:fixed; inset:0; background:var(--bg); color:var(--ink); display:none}
    body.reader-on .reader{display:block}
    .reader-wrap{max-width:var(--max); margin:0 auto; height:100%; padding:28px 18px 28px; display:flex; flex-direction:column; gap:14px}
    .reader-top{display:flex; align-items:baseline; justify-content:space-between; gap:10px}
    .reader-mark{font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; letter-spacing:0.18em; text-transform:uppercase; font-size:12px; color:var(--muted)}
    .reader-idx{font-family: ui-sans-serif, system-ui; font-size:12px; color:var(--muted)}
    .reader-card{flex:1; overflow:auto; background:#fff; border:1px solid var(--rule); border-radius:14px; padding:18px 16px}
    .reader-title{margin:0; font-size:18px}
    .reader-body{margin:12px 0 0; white-space:pre-wrap}
    .reader-nav{display:flex; justify-content:space-between; gap:10px}
    .reader-btn{border:1px solid var(--rule); background:#fff; border-radius:12px; padding:10px 12px; font-family: ui-sans-serif, system-ui; font-size:14px; cursor:pointer}
    .reader-btn:focus{outline:2px solid var(--focus); outline-offset:2px}
    .reader-btn[disabled]{opacity:.5; cursor:default}

    @media print{
      :root{--bg:#fff}
      nav, .controls, .bar, .r-actions {display:none !important}
      body{background:#fff}
      .wrap{max-width: 6.5in; padding:0.6in}
      .reflection, .preface, .law{border:1px solid #ddd; break-inside:avoid; box-shadow:none}
      a{text-decoration:none}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="kicker">MONK</div>
      <h1>MONK</h1>
      <p class="sub">Field manuals for orientation. Manufactured, not performed.</p>
</header>

    <hr />

    <section id="v1" aria-label="Volume I">
      <div class="section-title">
        <h2>VOLUME I</h2>
        <div class="meta">33 Reflections</div>
      </div>

      <div class="preface" id="v1-preface">
        <div class="label">Preface</div>
        <p class="line">For use.</p>
      </div>

      <div class="pause" aria-hidden="true"></div>
        <p class="line">For use.</p>
      </div>

      <div id="v1-text" class="meta" style="margin:6px 0 10px">Text</div>
      <div id="v1List"></div>
    </section>

    <hr />

    <section id="v2" aria-label="Volume II">
      <div class="section-title">
        <h2>VOLUME II</h2>
        <div class="meta">Stewardship</div>
      </div>

      <div id="v2-laws" class="meta" style="margin:12px 0 10px">33 Laws (headlines)</div>
      <div class="laws" id="lawsList"></div>

      <div id="v2-text" class="meta" style="margin:18px 0 10px">Text (in progress)</div>
      <div id="v2List"></div>

      <div class="preface" style="margin-top:14px">
        <div class="label">Note</div>
        <p class="line" style="font-size:14px; color:var(--muted)">Volume II text is being written. Headlines are locked.</p>
      </div>
    </section>

    
  </div>

  <script>
    const roman = [
      "I","II","III","IV","V","VI","VII","VIII","IX","X",
      "XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX",
      "XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX",
      "XXXI","XXXII","XXXIII"
    ];

    // NOTE: Data arrays (volume1, volume2Laws, volume2) are defined above this script.

    // ----------------------
    // SCROLL MODE RENDER
    // ----------------------

    const v1List = document.getElementById('v1List');
    const v2List = document.getElementById('v2List');
    const lawsList = document.getElementById('lawsList');

    function makeReflectionCard(ref, volumeKey){
      const id = `${volumeKey}-${ref.n}`;
      const el = document.createElement('article');
      el.className = 'reflection';
      el.id = id;

      const head = document.createElement('div');
      head.className = 'r-head';

      const left = document.createElement('div');
      const num = document.createElement('div');
      num.className = 'r-num';
      num.textContent = `${volumeKey.toUpperCase()} · ${roman[ref.n-1]}`;
      const title = document.createElement('h3');
      title.className = 'r-title';
      title.textContent = ref.title;
      left.appendChild(num);
      left.appendChild(title);

      head.appendChild(left);

      const body = document.createElement('div');
      body.className = 'r-body';
      body.textContent = ref.body;

      el.appendChild(head);
      el.appendChild(body);
      return el;
    }

    function renderScroll(){
      if(v1List){
        v1List.innerHTML = '';
        (window.volume1 || volume1).forEach(r => v1List.appendChild(makeReflectionCard(r,'v1')));
      }

      if(lawsList){
        lawsList.innerHTML = '';
        (window.volume2Laws || volume2Laws).forEach((t, i) => {
          const card = document.createElement('div');
          card.className = 'law';
          const n = document.createElement('div');
          n.className = 'n';
          n.textContent = `V2 · ${roman[i]}`;
          const tt = document.createElement('div');
          tt.className = 't';
          tt.textContent = t;
          card.appendChild(n);
          card.appendChild(tt);
          lawsList.appendChild(card);
        });
      }

      if(v2List){
        v2List.innerHTML = '';
        (window.volume2 || volume2).forEach(r => v2List.appendChild(makeReflectionCard(r,'v2')));
      }
    }

    // ----------------------
    // READER MODE (B)
    // ----------------------

    const all = [];
    (window.volume1 || volume1).forEach(r => all.push({key:'v1', n:r.n, title:r.title, body:r.body}));
    (window.volume2 || volume2).forEach(r => all.push({key:'v2', n:r.n, title:r.title, body:r.body}));

    const readerEl = document.createElement('div');
    readerEl.className = 'reader';
    readerEl.innerHTML = `
      <div class="reader-wrap" role="application" aria-label="Reading mode">
        <div class="reader-top">
          <div class="reader-mark">MONK</div>
          <div class="reader-idx" id="readerIdx"></div>
        </div>
        <div class="reader-card" id="readerCard" tabindex="0">
          <div class="r-num" id="readerNum"></div>
          <h3 class="reader-title" id="readerTitle"></h3>
          <div class="reader-body" id="readerBody"></div>
        </div>
        <div class="reader-nav">
          <button class="reader-btn" id="prevBtn" aria-label="Previous">Prev</button>
          <button class="reader-btn" id="nextBtn" aria-label="Next">Next</button>
        </div>
      </div>
    `;
    document.body.appendChild(readerEl);

    const readerIdx = readerEl.querySelector('#readerIdx');
    const readerNum = readerEl.querySelector('#readerNum');
    const readerTitle = readerEl.querySelector('#readerTitle');
    const readerBody = readerEl.querySelector('#readerBody');
    const readerCard = readerEl.querySelector('#readerCard');
    const prevBtn = readerEl.querySelector('#prevBtn');
    const nextBtn = readerEl.querySelector('#nextBtn');

    function hashFor(i){
      const r = all[i];
      return `#${r.key}-${r.n}`;
    }

    function indexFromHash(){
      const h = (location.hash || '').replace('#','').trim();
      if(!h) return 0;
      const m = h.match(/^(v1|v2)-(\d{1,2})$/);
      if(!m) return 0;
      const key = m[1];
      const n = parseInt(m[2],10);
      const idx = all.findIndex(x => x.key===key && x.n===n);
      return idx >= 0 ? idx : 0;
    }

    let idx = 0;

    function show(i, opts={push:false}){
      idx = Math.max(0, Math.min(all.length-1, i));
      const r = all[idx];
      readerIdx.textContent = `${idx+1} / ${all.length}`;
      readerNum.textContent = `${r.key.toUpperCase()} · ${roman[r.n-1]}`;
      readerTitle.textContent = r.title;
      readerBody.textContent = r.body;

      prevBtn.disabled = idx===0;
      nextBtn.disabled = idx===all.length-1;

      const h = hashFor(idx);
      if(opts.push) history.pushState({idx}, '', h);
      else history.replaceState({idx}, '', h);

      // reset scroll inside card
      readerCard.scrollTop = 0;
      readerCard.focus({preventScroll:true});
    }

    function next(){ if(idx < all.length-1) show(idx+1, {push:true}); }
    function prev(){ if(idx > 0) show(idx-1, {push:true}); }

    prevBtn.addEventListener('click', prev);
    nextBtn.addEventListener('click', next);

    // Keyboard navigation
    window.addEventListener('keydown', (e) => {
      if(!document.body.classList.contains('reader-on')) return;
      const k = e.key;
      if(k === 'ArrowRight' || k === 'ArrowDown' || k === 'j' || k === 'J' || k === ' '){ e.preventDefault(); next(); }
      if(k === 'ArrowLeft' || k === 'ArrowUp' || k === 'k' || k === 'K'){ e.preventDefault(); prev(); }
      if(k === 'Escape'){ e.preventDefault(); exitReader(); }
    }, {passive:false});

    // Touch swipe (basic)
    let sx=null, sy=null;
    readerEl.addEventListener('touchstart', (e)=>{
      if(e.touches.length!==1) return;
      sx=e.touches[0].clientX; sy=e.touches[0].clientY;
    }, {passive:true});
    readerEl.addEventListener('touchend', (e)=>{
      if(sx===null || sy===null) return;
      const dx = e.changedTouches[0].clientX - sx;
      const dy = e.changedTouches[0].clientY - sy;
      sx=sy=null;
      if(Math.abs(dx) < 60 || Math.abs(dx) < Math.abs(dy)) return;
      if(dx < 0) next();
      else prev();
    }, {passive:true});

    function enterReader(){
      document.body.classList.add('reader-on');
      show(indexFromHash(), {push:false});
    }

    function exitReader(){
      document.body.classList.remove('reader-on');
    }

    // Reader mode trigger:
    // - append ?read=1 to URL
    // - or press "r"
    window.addEventListener('keydown', (e)=>{
      if(e.key === 'r' || e.key === 'R'){
        if(document.body.classList.contains('reader-on')) return;
        enterReader();
      }
    });

    window.addEventListener('popstate', ()=>{
      if(!document.body.classList.contains('reader-on')) return;
      show(indexFromHash(), {push:false});
    });

    // ----------------------
    // BOOT
    // ----------------------

    renderScroll();

    const params = new URLSearchParams(location.search);
    if(params.has('read')) enterReader();

  </script>
</body>
</html>
